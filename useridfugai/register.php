<?php
include 'config.php';

if ($_SERVER['REQUEST_METHOD'] == 'POST') {
    $reg_username = $_POST['reg_username'];
    $name = $_POST['name'];
    $reg_password = $_POST['reg_password'];
    $hashed_password = md5($reg_password);
    $user_id = $_POST['user_id'];
    $is_admin = isset($_POST['is_admin']) ? 1 : 0;

    $check_sql = "SELECT * FROM users WHERE id = '$user_id'";
    $check_result = mysql_query($check_sql);
    if (mysql_num_rows($check_result) > 0) {
        $sql = "UPDATE users SET username = '$reg_username', name = '$name', password = '$hashed_password' WHERE id = $user_id";
    } else {
        $sql = "INSERT INTO users (id, username, name, password, is_admin) VALUES ('$user_id', '$reg_username', '$name', '$hashed_password', $is_admin)";
    }

    $result = mysql_query($sql);
    if ($result) {
        header('Location: login.php');
        exit;
    } else {
        echo 'Error: ' . mysql_error();
    }
}
?>

<!DOCTYPE html>
<html>
<head>
    <title>Register</title>
</head>
<body>
    <h1>Register</h1>
    <form action="register.php" method="post">
        <label for="user_id">User ID:</label>
        <input type="text" id="user_id" name="user_id" required>
        <label for="reg_username">Username:</label>
        <input type="text" id="reg_username" name="reg_username" required>
        <label for="name">Name:</label>
        <input type="text" id="name" name="name" required>
        <label for="reg_password">Password:</label>
        <input type="password" id="reg_password" name="reg_password" required>
        <input type="submit" value="Register">
    </form>
    <p>Already have an account? <a href="login.php">Login</a></p>
</body>
</html>
